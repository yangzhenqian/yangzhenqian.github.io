import{d as n}from"./app.c3ff6c08.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";const a={},e=n(`<h1 id="multi-repo-mono-repo" tabindex="-1"><a class="header-anchor" href="#multi-repo-mono-repo" aria-hidden="true">#</a> multi-repo &amp; mono-repo</h1><p>\u4E24\u79CD\u4EE3\u7801\u98CE\u683C\u4ED3\u5E93\u7684\u7BA1\u7406\u98CE\u683C</p><ul><li>multi-repo\uFF1A\u628A\u6BCF\u4E2A\u9879\u76EE\u90FD\u5206\u522B\u7528git\u6258\u7BA1</li><li>mono-repo\uFF1A \u7EDF\u4E00\u7528\u4E00\u4E2Agit\u4ED3\u5E93\u7BA1\u7406\u6240\u6709\u7684\u9879\u76EE</li></ul><h2 id="multi-repo" tabindex="-1"><a class="header-anchor" href="#multi-repo" aria-hidden="true">#</a> multi-repo</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// multi-repo</span>
root
<span class="token operator">|</span>\u2500\u2500 project<span class="token operator">-</span>a          
<span class="token operator">|</span>   \u251C\u2500\u2500 <span class="token operator">...</span>
<span class="token operator">|</span>   \u2514\u2500\u2500 <span class="token punctuation">.</span>git
\u251C\u2500\u2500 project<span class="token operator">-</span>b                 
<span class="token operator">|</span>   \u251C\u2500\u2500 <span class="token operator">...</span>                    
<span class="token operator">|</span>   \u2514\u2500\u2500 git
\u251C\u2500\u2500 project<span class="token operator">-</span>c                 
<span class="token operator">|</span>   \u251C\u2500\u2500 <span class="token operator">...</span>  
<span class="token operator">|</span>   \u2514\u2500\u2500 <span class="token punctuation">.</span>git
\u251C\u2500\u2500 project<span class="token operator">-</span>d                 
<span class="token operator">|</span>   \u251C\u2500\u2500 <span class="token operator">...</span>    
<span class="token operator">|</span>   \u2514\u2500\u2500 <span class="token punctuation">.</span>git
<span class="token operator">...</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u4ECE\u4E0A\u9762\u53EF\u4EE5\u770B\u51FA\u591A\u4E2A\u9879\u76EE\u5BF9\u5E94\u591A\u4E2A\u4ED3\u5E93\uFF0C\u5927\u591A\u6570\u5DE5\u7A0B\uFF0C\u5176\u5B9E\u90FD\u662F\u4EE5multi-repo\u65B9\u5F0F\u7BA1\u7406\u7684</p><ul><li><p>\u4F18\u52BF</p><p>\u53EF\u4EE5\u8BA9\u5404\u9879\u76EE\u56E2\u961F\u6839\u636E\u9700\u8981\u5B9A\u5236\u66F4\u9002\u5408\u81EA\u5DF1\u7684workflow</p></li><li><p>\u4E0D\u8DB3</p><ul><li>\u96BE\u4EE5\u5BF9\u6240\u6709\u9879\u76EE\u7EDF\u4E00\u8FDB\u884C\u64CD\u4F5C\uFF08git checkout / npm publish / npm run build\uFF09</li><li>\u96BE\u4EE5\u8FFD\u8E2A\u4F9D\u8D56\u5173\u7CFB\uFF08a-&gt;b-&gt;c</li></ul></li></ul><h2 id="mono-repo" tabindex="-1"><a class="header-anchor" href="#mono-repo" aria-hidden="true">#</a> mono-repo</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// multi-repo</span>

\u251C\u2500\u2500 <span class="token punctuation">.</span>git 
\u251C\u2500\u2500 lerna<span class="token punctuation">.</span>json
\u251C\u2500\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json                                        
\u251C\u2500\u2500 packages                 
    \u251C\u2500\u2500 project<span class="token operator">-</span>a
    <span class="token operator">|</span>    \u251C\u2500\u2500 <span class="token constant">README</span><span class="token punctuation">.</span>md
    <span class="token operator">|</span>    \u251C\u2500\u2500 __tests__
    <span class="token operator">|</span>    \u251C\u2500\u2500 lib
    <span class="token operator">|</span>    \u2514\u2500\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json
    \u251C\u2500\u2500 project<span class="token operator">-</span>b
    <span class="token operator">|</span>    \u251C\u2500\u2500 <span class="token constant">README</span><span class="token punctuation">.</span>md
    <span class="token operator">|</span>    \u251C\u2500\u2500 __tests__
    <span class="token operator">|</span>    \u251C\u2500\u2500 lib
    <span class="token operator">|</span>    \u2514\u2500\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json
    \u251C\u2500\u2500 project<span class="token operator">-</span>c
        \u251C\u2500\u2500 <span class="token constant">README</span><span class="token punctuation">.</span>md
        \u251C\u2500\u2500 __tests__
        \u251C\u2500\u2500 lib
        \u2514\u2500\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u4ECE\u4E0A\u9762\u53EF\u4EE5\u770B\u51FA\u4E00\u4E2A\u4ED3\u5E93\u7BA1\u7406\u591A\u4E2A\u9879\u76EE</p><ul><li><p>\u4F18\u52BF</p><ul><li>\u65B9\u4FBF\u7EDF\u4E00\u7684\u64CD\u4F5C\u5404\u4E2A\u9879\u76EE</li><li>\u5229\u7528\u5DE5\u5177\uFF0C\u53EF\u4EE5\u65B9\u4FBF\u7684\u8FFD\u8E2A\u9879\u76EE\u95F4\u7684\u4F9D\u8D56\u5173\u7CFB</li></ul></li><li><p>\u4E0D\u8DB3</p><ul><li>\u4EE3\u7801\u5E93\u968F\u7740\u4E1A\u52A1\u53D1\u5C55\u4F1A\u975E\u5E38\u5DE8\u5927</li><li>\u5931\u53BB\u90E8\u5206\u7684\u7075\u6D3B\u6027\uFF08workflow\u5FC5\u987B\u7EDF\u4E00\uFF09</li><li>\u5F3A\u4F9D\u8D56\u4E8Emonorepo\u7684\u7BA1\u7406\u5DE5\u5177</li></ul></li></ul><h2 id="mono-repo\u7684\u7BA1\u7406-lerna" tabindex="-1"><a class="header-anchor" href="#mono-repo\u7684\u7BA1\u7406-lerna" aria-hidden="true">#</a> mono-repo\u7684\u7BA1\u7406-lerna</h2><p>\u4E3Ajs\u751F\u6001\u4E0B\u7684mono-repo\u7BA1\u7406\u63D0\u4F9B\u4E00\u7AD9\u5F0F\u7684\u89E3\u51B3\u65B9\u6848</p><h3 id="\u76EE\u5F55\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u76EE\u5F55\u7ED3\u6784" aria-hidden="true">#</a> \u76EE\u5F55\u7ED3\u6784</h3><ul><li>\u6574\u4F53\u4F5C\u4E3A\u4E00\u4E2AGit\u4ED3\u5E93\uFF0C\u4E5F\u662F\u4E2Anpm\u5305\uFF08\u79C1\u6709\uFF09</li><li>lerna.json\u662F\u6574\u4E2Ammono-repo\u7684\u914D\u7F6E\u6587\u4EF6</li><li>\u6BCF\u4E2A\u771F\u6B63\u7684\u9879\u76EE\uFF0C\u5E73\u94FA\u5728packages/\u4E2D</li><li>\u6574\u4E2A\u9879\u76EE\u53EF\u4EE5\u7EDF\u4E00\u7BA1\u7406\u6240\u6709\u4F9D\u8D56\uFF08\u4E5F\u53EF\u4EE5\u5206\u522B\u7BA1\u7406\uFF09</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// lerna</span>
\u251C\u2500\u2500 <span class="token punctuation">.</span>git 
\u251C\u2500\u2500 lerna<span class="token punctuation">.</span>json
\u251C\u2500\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json                                        
\u251C\u2500\u2500 packages                 
    \u251C\u2500\u2500 project<span class="token operator">-</span>a
    <span class="token operator">|</span>    \u251C\u2500\u2500 <span class="token constant">README</span><span class="token punctuation">.</span>md
    <span class="token operator">|</span>    \u251C\u2500\u2500 __tests__
    <span class="token operator">|</span>    \u251C\u2500\u2500 lib
    <span class="token operator">|</span>    \u2514\u2500\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json
    \u251C\u2500\u2500 project<span class="token operator">-</span>b
    <span class="token operator">|</span>    \u251C\u2500\u2500 <span class="token constant">README</span><span class="token punctuation">.</span>md
    <span class="token operator">|</span>    \u251C\u2500\u2500 __tests__
    <span class="token operator">|</span>    \u251C\u2500\u2500 lib
    <span class="token operator">|</span>    \u2514\u2500\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json
    \u251C\u2500\u2500 project<span class="token operator">-</span>c
        \u251C\u2500\u2500 <span class="token constant">README</span><span class="token punctuation">.</span>md
        \u251C\u2500\u2500 __tests__
        \u251C\u2500\u2500 lib
        \u2514\u2500\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="\u7528lerna\u7BA1\u7406\u9879\u76EE\u7684\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#\u7528lerna\u7BA1\u7406\u9879\u76EE\u7684\u76F8\u5173" aria-hidden="true">#</a> \u7528lerna\u7BA1\u7406\u9879\u76EE\u7684\u76F8\u5173</h3><ol><li>\u5B89\u88C5lerna</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5168\u5C40\u5B89\u88C5lerna</span>
<span class="token function">npm</span> i lerna -g 
<span class="token comment"># \u7528lerna\u521D\u59CB\u5316\u4E00\u4E2A\u9879\u76EE</span>
lerna init
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u521D\u59CB\u5316\u7684\u76EE\u5F55\u7ED3\u6784</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>- packages
  - lerna.json
  - package.json
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>lerna.json\u6587\u4EF6\u4E2D\u90FD\u6709\u4EC0\u4E48\u914D\u7F6E</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token comment">// \u914D\u7F6E$schema\u53EF\u4EE5\u5728vscode\u4E2D\uFF0C\u9F20\u6807\u6ED1\u5012\u6BCF\u4E2A\u914D\u7F6E\u9879\u65F6\u5019\uFF0C\u53EF\u4EE5\u770B\u6BCF\u4E2A\u914D\u7F6E\u9879\u7684\u4ECB\u7ECD </span>
  <span class="token comment">// \u53EF\u4EE5\u5728https://www.schemastore.org/json/\u4E2D\u7F51\u7AD9\u67E5\u770B\u77E5\u540D\u9879\u76EE\u7684\u63CF\u8FF0\u6587\u4EF6</span>
  <span class="token property">&quot;$schema&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://json.schemastore.org/lerna&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;packages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;packages/*&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;independent&quot;</span> <span class="token comment">// \u53EF\u4EE5\u7ED9\u5404\u4E2A\u9879\u76EE\u53D1\u4E0D\u540C\u7684\u7248\u672C</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="2"><li>\u6DFB\u52A0\u9879\u76EE\u4F9D\u8D56</li></ol><p>\u6211\u4EEC\u4E3Apac-1\u3001 pac-2\u3001pac-3\u6DFB\u52A0\u4F9D\u8D56\u5173\u7CFB\uFF0C\u6211\u4EEC\u5236\u9020\u8FD9\u6837\u4E00\u79CD\u4F9D\u8D56\uFF0Cpac-1\u6A21\u5757\u88ABpac-2\u4F9D\u8D56\uFF1Bpac-2\u6A21\u5757\u88ABpac-3\u6A21\u5757\u4F9D\u8D56\uFF0C \u8FD9\u65F6\u5019\u5C31\u5F62\u6210\u4E86pac-1\u3001 pac-2\u3001pac-3\u95F4\u63A5\u4F9D\u8D56\u5173\u7CFB\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5236\u9020\u4F9D\u8D56\u5173\u7CFB\uFF0C\u5BF9\u4E8E\u5185\u90E8\u9879\u76EE\u7684\u4F9D\u8D56\uFF0Clerna\u4F1A\u4EE5\u8F6F\u8FDE\u63A5\u7684\u5F62\u5F0F\uFF0C\u7ED9\u5B83\u4EEC\u76F8\u4E92\u8F6F\u94FE\u63A5\u8D77\u6765</span>
lerna <span class="token function">add</span> pac-1 packages/pac-2
lerna <span class="token function">add</span> pac-2 packages/pac-3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5982\u679C\u6211\u4EEC\u7ED9\u9879\u76EE\u6DFB\u52A0\u5916\u90E8\u4F9D\u8D56\uFF0C\u53EF\u80FD\u9700\u8981\u7ED9\u6BCF\u4E2A\u9879\u76EEnode_moudles\u90FD\u6DFB\u52A0\uFF0C\u540C\u4E00\u4E2A\u4F9D\u8D56\u4F1A\u5B89\u88C5\u5F88\u591A\u6B21\uFF0C\u8FD9\u663E\u7136\u4E0D\u5408\u7406\uFF0C\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0Cleran\u53EF\u4EE5\u628A\u4F9D\u8D56\u6DFB\u52A0\u5230\u9879\u76EE\u6839\u76EE\u5F55\uFF1B<code>lerna clean</code>\u53BB\u6E05\u9664\u6BCF\u4E2A\u9879\u76EE\u4E2Dnode_modules\u76F8\u540C\u7684\u4F9D\u8D56;\u7528 <code>lerna bootstrap --hoist</code>\u91CD\u65B0\u5B89\u88C5\u4F9D\u8D56\uFF0C</p><ol start="3"><li>\u53D1\u7248</li></ol><p>\u9700\u8981\u6CE8\u610F\u662F\u7684 lerna.json \u914D\u7F6E\u4E3A&quot;version&quot;: &quot;independent&quot;\u65F6\u53EF\u4EE5\u4E3A\u6BCF\u4E2A\u5305\u72EC\u7ACB\u53D1\u4E0D\u540C\u7684\u7248\u672C\uFF0C\u5982\u679C&quot;version&quot;:&#39;0.0.0&#39;\u662F\u53D1\u540C\u6837\u7684\u7248\u672C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>lerna publish
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ol start="4"><li>\u5176\u4ED6</li></ol><p>\u53EF\u4EE5\u7528lerna -h\u67E5\u770B\u5168\u90E8\u6307\u4EE4</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>lerna  <span class="token builtin class-name">exec</span> <span class="token punctuation">[</span>cmd<span class="token punctuation">]</span> <span class="token punctuation">[</span>args<span class="token punctuation">..</span>.<span class="token punctuation">]</span> <span class="token comment"># \u6267\u884C\u6BCF\u4E00\u4E2Apackage.json\u4F60\u60F3\u6307\u884C\u7684\u547D\u4EE4</span>
lerna run <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span> <span class="token comment"># \u6267\u884Cpackage.josn \u4E2Dscript\u914D\u7F6E\u7684\u547D\u4EE4</span>
lerna <span class="token function">diff</span> <span class="token punctuation">[</span>pkgName<span class="token punctuation">]</span> <span class="token comment"># \u5BF9\u6BD4 \u6587\u4EF6\u53D8\u5316</span>
lerna changed <span class="token comment"># \u67E5\u770B\u6587\u4EF6\u53D8\u5316</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>`,33);function p(l,o){return e}var t=s(a,[["render",p]]);export{t as default};
