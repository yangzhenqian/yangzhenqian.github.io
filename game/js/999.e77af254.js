"use strict";(self["webpackChunkgame"]=self["webpackChunkgame"]||[]).push([[999],{6999:function(e,i,t){t.r(i),t.d(i,{default:function(){return H}});var s=t(3396),r=t(7139),l=t(9242);const n=e=>((0,s.dD)("data-v-4cf47eb2"),e=e(),(0,s.Cn)(),e),o={class:"gobang-game"},a={class:"game-header"},c={class:"game-info"},h={class:"timer-container"},d={class:"move-timer"},m={class:"total-timer"},u={class:"current-player"},v={key:0,class:"game-status"},g={class:"controls"},y=["disabled"],p=n((()=>(0,s._)("option",{value:"30"},"30秒/步",-1))),w=n((()=>(0,s._)("option",{value:"60"},"60秒/步",-1))),P=n((()=>(0,s._)("option",{value:"120"},"120秒/步",-1))),b=[p,w,P],f=["disabled"],S={class:"board-container"},T={class:"grid-container"},k=n((()=>(0,s._)("div",{class:"grid-cell-inner"},null,-1))),_=[k],z={class:"grid-lines"},x=n((()=>(0,s._)("div",{class:"game-footer"},[(0,s._)("div",{class:"game-tips"},[(0,s._)("p",null,"点击棋盘落子，五子连线获胜"),(0,s._)("p",null,"可以使用悔棋功能撤回上一步")])],-1)));function M(e,i,t,n,p,w){return(0,s.wg)(),(0,s.iD)("div",o,[(0,s._)("div",a,[(0,s._)("div",c,[(0,s._)("div",h,[(0,s._)("div",d," 步时: "+(0,r.zw)(w.formatTime(p.moveTimeLeft)),1),(0,s._)("div",m," 总时: "+(0,r.zw)(w.formatTime(p.totalTime)),1)]),(0,s._)("div",u,[(0,s.Uk)(" 当前: "),(0,s._)("span",{class:(0,r.C_)(p.currentPlayer)},(0,r.zw)("black"===p.currentPlayer?"黑棋":"白棋"),3)]),p.winner?((0,s.wg)(),(0,s.iD)("div",v,[(0,s.Uk)(" 获胜方: "),(0,s._)("span",{class:(0,r.C_)(p.winner)},(0,r.zw)("black"===p.winner?"黑棋":"白棋"),3)])):(0,s.kq)("",!0)]),(0,s._)("div",g,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":i[0]||(i[0]=e=>p.timeLimit=e),onChange:i[1]||(i[1]=(...e)=>w.resetGame&&w.resetGame(...e)),disabled:p.isPlaying},b,40,y),[[l.bM,p.timeLimit]]),(0,s._)("button",{onClick:i[2]||(i[2]=(...e)=>w.undoMove&&w.undoMove(...e)),disabled:!w.canUndo||p.winner},"悔棋",8,f),(0,s._)("button",{onClick:i[3]||(i[3]=(...e)=>w.resetGame&&w.resetGame(...e))},"重新开始")])]),(0,s._)("div",S,[(0,s._)("div",{class:"board",ref:"board",onClick:i[4]||(i[4]=(...e)=>w.handleClick&&w.handleClick(...e)),style:(0,r.j5)(w.boardStyle)},[(0,s._)("div",T,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.boardSize,(e=>((0,s.wg)(),(0,s.iD)("div",{key:"row-"+e,class:"grid-row"},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.boardSize,(i=>((0,s.wg)(),(0,s.iD)("div",{key:"cell-"+e+"-"+i,class:"grid-cell"},_)))),128))])))),128))]),(0,s._)("div",z,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.boardSize-1,(e=>((0,s.wg)(),(0,s.iD)("div",{key:"h"+e,class:"h-line"})))),128)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.boardSize-1,(e=>((0,s.wg)(),(0,s.iD)("div",{key:"v"+e,class:"v-line"})))),128))]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.starPoints,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.x+"-"+e.y,class:"star-point",style:(0,r.j5)(w.getPointStyle(e))},null,4)))),128)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.pieces,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id,class:(0,r.C_)(["piece",[e.color,{"last-move":w.isLastMove(e)}]]),style:(0,r.j5)(w.getPieceStyle(e))},null,6)))),128)),p.hoverPosition&&!p.winner?((0,s.wg)(),(0,s.iD)("div",{key:0,class:(0,r.C_)(["hover-piece",p.currentPlayer]),style:(0,r.j5)(w.getHoverStyle())},null,6)):(0,s.kq)("",!0)],4)]),x])}t(7658);var L={name:"GobangGame",data(){return{boardSize:15,cellSize:40,pieces:[],currentPlayer:"black",winner:null,history:[],hoverPosition:null,starPoints:[{x:3,y:3},{x:3,y:11},{x:11,y:3},{x:11,y:11},{x:7,y:7}],timeLimit:60,moveTimeLeft:60,totalTime:0,moveTimer:null,totalTimer:null,isPlaying:!1}},computed:{boardStyle(){const e=this.boardSize*this.cellSize;return{width:`${e}px`,height:`${e}px`}},canUndo(){return this.pieces.length>0}},mounted(){this.$refs.board.addEventListener("mousemove",this.handleMouseMove),this.$refs.board.addEventListener("mouseleave",(()=>{this.hoverPosition=null}))},beforeUnmount(){this.$refs.board.removeEventListener("mousemove",this.handleMouseMove),this.stopTimers()},methods:{handleMouseMove(e){if(this.winner)return;const i=e.target.getBoundingClientRect(),t=e.clientX-i.left,s=e.clientY-i.top,r=Math.round(t/this.cellSize),l=Math.round(s/this.cellSize);r>=0&&r<this.boardSize&&l>=0&&l<this.boardSize?this.hoverPosition={x:r,y:l}:this.hoverPosition=null},handleClick(e){if(this.winner)return;const i=e.target.getBoundingClientRect(),t=e.clientX-i.left,s=e.clientY-i.top,r=Math.round(t/this.cellSize),l=Math.round(s/this.cellSize);this.isValidPosition(r,l)&&!this.getPieceAt(r,l)&&this.placePiece(r,l)},isValidPosition(e,i){return e>=0&&e<this.boardSize&&i>=0&&i<this.boardSize},getPieceAt(e,i){return this.pieces.find((t=>t.x===e&&t.y===i))},placePiece(e,i){this.saveState(),this.pieces.push({id:Date.now(),x:e,y:i,color:this.currentPlayer}),this.checkWin(e,i)?(this.winner=this.currentPlayer,this.stopTimers()):(this.currentPlayer="black"===this.currentPlayer?"white":"black",this.resetMoveTimer()),1===this.pieces.length&&this.startTimers()},checkWin(e,i){const t=[[1,0],[0,1],[1,1],[1,-1]];return t.some((([t,s])=>this.countLine(e,i,t,s)>=5))},countLine(e,i,t,s){const r=this.currentPlayer;let l=1,n=e+t,o=i+s;while(this.isValidPosition(n,o)){const e=this.getPieceAt(n,o);if(!e||e.color!==r)break;l++,n+=t,o+=s}n=e-t,o=i-s;while(this.isValidPosition(n,o)){const e=this.getPieceAt(n,o);if(!e||e.color!==r)break;l++,n-=t,o-=s}return l},getPieceStyle(e){return{left:e.x*this.cellSize+"px",top:e.y*this.cellSize+"px"}},getPointStyle(e){return{left:e.x*this.cellSize+"px",top:e.y*this.cellSize+"px"}},getHoverStyle(){return this.hoverPosition?{left:this.hoverPosition.x*this.cellSize+"px",top:this.hoverPosition.y*this.cellSize+"px"}:{}},isLastMove(e){return e===this.pieces[this.pieces.length-1]},saveState(){this.history.push({pieces:JSON.parse(JSON.stringify(this.pieces)),currentPlayer:this.currentPlayer,winner:this.winner})},undoMove(){if(this.canUndo&&!this.winner){const e=this.history.pop();this.pieces=e.pieces,this.currentPlayer=e.currentPlayer,this.winner=e.winner}},resetGame(){this.stopTimers(),this.pieces=[],this.currentPlayer="black",this.winner=null,this.history=[],this.totalTime=0,this.moveTimeLeft=this.timeLimit},startTimers(){this.isPlaying=!0,this.totalTimer=setInterval((()=>{this.totalTime++}),1e3),this.resetMoveTimer()},resetMoveTimer(){this.moveTimer&&clearInterval(this.moveTimer),this.moveTimeLeft=this.timeLimit,this.moveTimer=setInterval((()=>{this.moveTimeLeft>0?this.moveTimeLeft--:this.timeOut()}),1e3)},timeOut(){this.winner="black"===this.currentPlayer?"white":"black",this.stopTimers()},stopTimers(){this.isPlaying=!1,this.moveTimer&&(clearInterval(this.moveTimer),this.moveTimer=null),this.totalTimer&&(clearInterval(this.totalTimer),this.totalTimer=null)},formatTime(e){const i=Math.floor(e/60),t=e%60;return`${i}:${t.toString().padStart(2,"0")}`}}},D=t(89);const C=(0,D.Z)(L,[["render",M],["__scopeId","data-v-4cf47eb2"]]);var H=C}}]);