"use strict";(self["webpackChunkgame"]=self["webpackChunkgame"]||[]).push([[59],{3059:function(e,t,s){s.r(t),s.d(t,{default:function(){return z}});var i=s(3396),l=s(7139),r=s(9242);const o=e=>((0,i.dD)("data-v-56c33363"),e=e(),(0,i.Cn)(),e),a={class:"sudoku-game"},n={class:"game-header"},d={class:"game-info"},u={class:"timer"},h={class:"mistakes"},m={class:"controls"},c=["disabled"],f=o((()=>(0,i._)("option",{value:"easy"},"简单",-1))),b=o((()=>(0,i._)("option",{value:"medium"},"中等",-1))),v=o((()=>(0,i._)("option",{value:"hard"},"困难",-1))),C=[f,b,v],g=["disabled"],k={class:"board-container"},p={class:"board"},w=["onClick"],y={class:"number-pad"},T=["onClick","disabled"],_=["disabled"],S={class:"game-footer"},M={key:0,class:"best-times"},x=o((()=>(0,i._)("h3",null,"最佳时间",-1))),N=o((()=>(0,i._)("div",{class:"instructions"},[(0,i._)("p",null,"选择格子后输入数字，每行、每列和每个3x3宫格中的数字不能重复"),(0,i._)("p",null,"三次错误将导致游戏结束")],-1)));function G(e,t,s,o,f,b){return(0,i.wg)(),(0,i.iD)("div",a,[(0,i._)("div",n,[(0,i._)("div",d,[(0,i._)("div",u,"⏱️ "+(0,l.zw)(b.formatTime(f.time)),1),(0,i._)("div",h,"错误: "+(0,l.zw)(f.mistakes)+"/3",1)]),(0,i._)("div",m,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>f.difficulty=e),onChange:t[1]||(t[1]=(...e)=>b.newGame&&b.newGame(...e)),disabled:f.isPlaying},C,40,c),[[r.bM,f.difficulty]]),(0,i._)("button",{onClick:t[2]||(t[2]=(...e)=>b.newGame&&b.newGame(...e)),class:"new-game-btn"},"新游戏"),(0,i._)("button",{onClick:t[3]||(t[3]=(...e)=>b.stopGame&&b.stopGame(...e)),class:"stop-game-btn",disabled:!f.isPlaying}," 终止游戏 ",8,g)])]),(0,i._)("div",k,[(0,i._)("div",p,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(f.board,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"row"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e,((e,s)=>((0,i.wg)(),(0,i.iD)("div",{key:s,class:(0,l.C_)(["cell",{fixed:e.fixed,selected:b.isSelected(t,s),related:b.isRelated(t,s),error:e.error,"same-number":b.isSameNumber(t,s)}]),onClick:e=>b.selectCell(t,s)},(0,l.zw)(e.value||""),11,w)))),128))])))),128))]),(0,i._)("div",y,[((0,i.wg)(),(0,i.iD)(i.HY,null,(0,i.Ko)(9,(e=>(0,i._)("button",{key:e,onClick:t=>b.inputNumber(e),disabled:!f.selectedCell||!b.isValidMove(e),class:(0,l.C_)({"used-up":b.isNumberComplete(e)})},(0,l.zw)(e),11,T))),64)),(0,i._)("button",{onClick:t[4]||(t[4]=(...e)=>b.eraseNumber&&b.eraseNumber(...e)),disabled:!f.selectedCell||!b.canErase}," ⌫ ",8,_)])]),(0,i._)("div",S,[f.bestTimes[f.difficulty]?((0,i.wg)(),(0,i.iD)("div",M,[x,(0,i._)("p",null,(0,l.zw)(b.formatTime(f.bestTimes[f.difficulty])),1)])):(0,i.kq)("",!0),N])])}var B={name:"SudokuGame",data(){return{difficulty:"easy",difficultySettings:{easy:{blanks:30},medium:{blanks:45},hard:{blanks:60}},board:[],solution:[],selectedCell:null,mistakes:0,time:0,timer:null,isPlaying:!1,bestTimes:{easy:1/0,medium:1/0,hard:1/0}}},computed:{canErase(){if(!this.selectedCell)return!1;const{row:e,col:t}=this.selectedCell;return!this.board[e][t].fixed&&this.board[e][t].value}},mounted(){this.loadBestTimes(),this.newGame()},beforeUnmount(){this.stopTimer()},methods:{newGame(){this.stopTimer(),this.mistakes=0,this.time=0,this.selectedCell=null,this.generateBoard(),this.startTimer(),this.isPlaying=!0},generateBoard(){this.solution=this.generateSolution();const e=this.difficultySettings[this.difficulty].blanks;this.board=this.solution.map((e=>e.map((e=>({value:e,fixed:!0,error:!1})))));let t=0;while(t<e){const e=Math.floor(9*Math.random()),s=Math.floor(9*Math.random());null!==this.board[e][s].value&&(this.board[e][s].value=null,this.board[e][s].fixed=!1,t++)}},generateSolution(){const e=Array(9).fill().map((()=>Array(9).fill(null)));for(let t=0;t<9;t+=3)this.fillBox(e,t,t);return this.solveSudoku(e),e},fillBox(e,t,s){const i=[1,2,3,4,5,6,7,8,9];for(let l=0;l<3;l++)for(let r=0;r<3;r++){let o;do{o=Math.floor(Math.random()*i.length)}while(!this.isSafe(e,t+l,s+r,i[o]));e[t+l][s+r]=i[o],i.splice(o,1)}},solveSudoku(e){let t=0,s=0,i=!1;for(let l=0;l<9;l++){for(let r=0;r<9;r++)if(null===e[l][r]){t=l,s=r,i=!0;break}if(i)break}if(!i)return!0;for(let l=1;l<=9;l++)if(this.isSafe(e,t,s,l)){if(e[t][s]=l,this.solveSudoku(e))return!0;e[t][s]=null}return!1},isSafe(e,t,s,i){for(let o=0;o<9;o++)if(e[t][o]===i)return!1;for(let o=0;o<9;o++)if(e[o][s]===i)return!1;const l=3*Math.floor(t/3),r=3*Math.floor(s/3);for(let o=0;o<3;o++)for(let t=0;t<3;t++)if(e[o+l][t+r]===i)return!1;return!0},selectCell(e,t){this.isPlaying&&!this.board[e][t].fixed&&(this.selectedCell={row:e,col:t})},inputNumber(e){if(!this.selectedCell||!this.isValidMove(e))return;const{row:t,col:s}=this.selectedCell,i=this.board[t][s];i.fixed||(this.solution[t][s]!==e?(i.error=!0,this.mistakes++,setTimeout((()=>{i.error=!1}),1e3),this.mistakes>=3&&this.gameOver(!1)):(i.value=e,this.checkWin()&&this.gameOver(!0)))},eraseNumber(){if(!this.selectedCell||!this.canErase)return;const{row:e,col:t}=this.selectedCell;this.board[e][t].value=null},isSelected(e,t){return this.selectedCell&&this.selectedCell.row===e&&this.selectedCell.col===t},isRelated(e,t){if(!this.selectedCell)return!1;const{row:s,col:i}=this.selectedCell;if(e===s||t===i)return!0;const l=Math.floor(e/3)===Math.floor(s/3),r=Math.floor(t/3)===Math.floor(i/3);return l&&r},isSameNumber(e,t){if(!this.selectedCell)return!1;const s=this.board[this.selectedCell.row][this.selectedCell.col].value;return s&&this.board[e][t].value===s},checkWin(){for(let e=0;e<9;e++)for(let t=0;t<9;t++)if(!this.board[e][t].value||this.board[e][t].value!==this.solution[e][t])return!1;return!0},gameOver(e){this.stopTimer(),this.isPlaying=!1,e?(this.time<this.bestTimes[this.difficulty]&&(this.bestTimes[this.difficulty]=this.time,this.saveBestTimes()),setTimeout((()=>{alert(`恭喜你赢了！\n用时：${this.formatTime(this.time)}`)}),100)):setTimeout((()=>{alert("游戏结束：错误次数过多")}),100)},stopGame(){confirm("确定要终止当前游戏吗？")&&(this.stopTimer(),this.isPlaying=!1,this.selectedCell=null,this.board=this.solution.map((e=>e.map((e=>({value:e,fixed:!0,error:!1}))))),setTimeout((()=>{alert(`游戏已终止！\n用时：${this.formatTime(this.time)}`)}),100))},startTimer(){this.timer=setInterval((()=>{this.time++}),1e3)},stopTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)},formatTime(e){const t=Math.floor(e/60),s=e%60;return`${t}:${s.toString().padStart(2,"0")}`},loadBestTimes(){const e=localStorage.getItem("sudoku-best-times");e&&(this.bestTimes=JSON.parse(e))},saveBestTimes(){localStorage.setItem("sudoku-best-times",JSON.stringify(this.bestTimes))},isValidMove(e){if(!this.selectedCell)return!1;const{row:t,col:s}=this.selectedCell;if(this.board[t][s].fixed)return!1;for(let r=0;r<9;r++)if(r!==s&&this.board[t][r].value===e)return!1;for(let r=0;r<9;r++)if(r!==t&&this.board[r][s].value===e)return!1;const i=3*Math.floor(t/3),l=3*Math.floor(s/3);for(let r=0;r<3;r++)for(let o=0;o<3;o++){const a=i+r,n=l+o;if(a!==t&&n!==s&&this.board[a][n].value===e)return!1}return!0},isNumberComplete(e){let t=0;for(let s=0;s<9;s++)for(let i=0;i<9;i++)this.board[s]?.[i]?.value===e&&t++;return t>=9}}},D=s(89);const P=(0,D.Z)(B,[["render",G],["__scopeId","data-v-56c33363"]]);var z=P}}]);